tell application "Finder"		(* OPENING INITIALIZATION *)		set desktopPath to path to desktop -- Sets path to current user's desktop as variable		set startupPath to path to startup disk -- Sets path to current startup disk as variable		tell application "iPhoto" to set theEvents to get name of every album -- Gets name of every iPhoto album		(* MAIN LOOP *)		repeat with i from 10 to number of items in theEvents -- Bypasses default albums i.e. events, faces, places, trash, etc.				delay 5				set this_item to item i of theEvents -- Gets name of current album				(* IF/ELSE LOOP *)				if (exists folder (this_item as string)) then -- Checks if folder exists						tell application "iPhoto" to set theImagePaths to image path of photos of album this_item -- Gets the path to file in iPhoto database						set DestinationFile to (desktopPath as text) & (this_item as string) as alias -- Sets the destination for copying files to album folder on desktop						set filePath to desktopPath & "allPaths.csv" -- Sets the name and path of the CSV file that logs all original paths of photos						repeat with i from 1 to number of items in theImagePaths								set AppleScript's text item delimiters to "
"								set thisFile to item i of theImagePaths								set originalFile to POSIX path of ((startupPath as text) & (thisFile as string)) as alias								duplicate originalFile to folder DestinationFile with replacing								set photoPath to originalFile as text								writeTo(filePath, photoPath, text, true) of me							end repeat					else						make new folder at desktopPath with properties {name:this_item as string}						tell application "iPhoto" to set theImagePaths to image path of photos of album this_item						set DestinationFile to (desktopPath as text) & (this_item as string) as alias						set filePath to desktopPath & "allPaths.csv"						repeat with i from 1 to number of items in theImagePaths								set AppleScript's text item delimiters to "
"								set thisFile to item i of theImagePaths								set originalFile to POSIX path of ((startupPath as text) & (thisFile as string)) as alias								duplicate originalFile to folder DestinationFile with replacing								set photoPath to originalFile as text								writeTo(filePath, photoPath, text, true) of me							end repeat					end if			end repeat	end tellon writeTo(targetFile, theData, dataType, appendData) -- Function written by regulus6633 of macscripter.net with slight modifications by Tyler Sparr	-- targetFile is the path to the file you want to write	-- theData is the data you want in the file.	-- dataType is the data type of theData and it can be text, list, record etc.	-- appendData is true to append theData to the end of the current contents of the file or false to overwrite it	try		set targetFile to targetFile as text		set openFile to open for access file targetFile with write permission		if appendData is false then set eof of openFile to 0		write theData & return to openFile starting at eof as dataType		close access openFile		return true	on error		try			close access file targetFile		end try		return false	end tryend writeTo